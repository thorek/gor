enum:
  SecuritySpecifics:
    - confidantality
    - integrity
    - availability
    - formal


entity:

  RiskAssessment:
    description: >
      Used to asses a risk priority by the calculation: probality x damage
        1 - 3 normal
        4 - 8 high
        8 ..  very high
      Asses the risk at the absence of any of the the special measures. It is assumed that basic "measures"
      (e.g. Password protected PC, Simple lock in doors) exist. If the assumptions are not realistic - it will
      be documented.
    attributes:
      probality:
        type: int
        required: true
        validation:
          min: 1
          max: 4
      probalityDescription:
        type: string
        required: false
        description: Reasoning why a certain probality is assumed
      damage:
        type: int
        required: true
        validation:
          min: 1
          max: 4
      damageDescription:
        type: string
        required: false
        description: Reasoning why a certain damage is assumed
      priority:
        type: Priority
        required: false
        description: if set this value will override the priority calculated by probality x damage

  DataSecurityRiskSourceUnion:
    entities:
      - DataAtom
      - ProcessingActivity
      - OrganisationalUnit
      - Organisation

  DataSecurityRiskSource:
    interface: true
    attributes:
      description: string

  DataSecurityRequirement:
    attributes:
      specific: SecuritySpecifics
      description:
        - type: string
          required: false
    assocTo:
      - RiskAssessment
      - DataSecurityRiskSource
    seeds:
      "1":
        DataSecurityRiskSource: DataAtom:ContactData:VN
        RiskAssessment:
          probality: 2
          damage: 1
        specific: confidantality
        description: Geringes Risiko
      "2":
        DataSecurityRiskSource: DataAtom:HealthData:VP
        RiskAssessment:
          probality: 2
          damage: 4
        specific: confidantality
        description: Hohes Risiko; Daten nach Art. 9 DSGVO
      "3":
        DataSecurityRiskSource: PA:BeratungHP
        RiskAssessment:
          probality: 2
          damage: 1
        specific: integrity
        description: Geringes Risiko
      "4":
        DataSecurityRiskSource: PA:GWG
        RiskAssessment:
          probality: 3
          probalityDescription: >
            da Ausweiskopie ausgedruckt wird, höhere Wahrscheinlichkeit dass der physische Aktenordner
            entwendet wird, als ein
          damage: 4
        description: Hohes Risiko; Daten nach Art. 9; Gefahr eines Identitätsdiebstahls
      "5":

  DataAtom:
    implements:
      - DataSecurityRiskSource
    attributes:
      description: string

  ProcessingActivity:
    implements: DataSecurityRiskSource
    attributes:
      name: string!
      purpose: string

  OrganisationalUnit:
    implements: DataSecurityRiskSource
    attributes:
      name: string!

  Organisation:
    implements: DataSecurityRiskSource
    attributes:
      name: string!
    assocFrom:
      - DataSecurityRequirement


